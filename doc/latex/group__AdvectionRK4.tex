\hypertarget{group__AdvectionRK4}{\section{Advection}
\label{group__AdvectionRK4}\index{Advection@{Advection}}
}


Provides data structures and methods for R\+K4 timestepping meshes in advection problems on a sphere.  


\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public \hyperlink{group__AdvectionRK4_ga9a42b57d9bea0b541418b2bb32ae1ba1}{advectionmodule\+::advectionrk4timestep} (self, a\+Mesh, dt, t, proc\+Rank, n\+Procs, velocity\+Function)
\begin{DoxyCompactList}\small\item\em Advances a spherical mesh advection problem one time step using 4th order Runge-\/\+Kutta. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{group__AdvectionRK4_ga60bf7e4fea5c15f0e916c04888b9770b}{advectionmodule\+::zerork4} (self)
\begin{DoxyCompactList}\small\item\em Sets arrays used by Runge-\/\+Kutta to zero to prevent contamination of current timestep from previous data. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{group__AdvectionRK4_ga0eaf17769aa944b4bded630e3eb300c1}{advectionmodule\+::setalpha} (new\+Alpha)
\begin{DoxyCompactList}\small\item\em Sets the angle of inclination (relative to the z-\/axis) for solid body rotation. \end{DoxyCompactList}\item 
real(kreal) function, \\*
dimension(3), public \hyperlink{group__AdvectionRK4_ga7f11298031417d6f2c3987bd4b363c37}{advectionmodule\+::lauritzenetalnondivergentwind} (xyz, t)
\begin{DoxyCompactList}\small\item\em Outputs velocity at postion xyz and time t corresponding to the non-\/divergent test cases found in \cite{LauritzenEtAl2012}. \end{DoxyCompactList}\item 
real(kreal) function, \\*
dimension(3), public \hyperlink{group__AdvectionRK4_ga8f7661486a24b73e0ccff377adfb29db}{advectionmodule\+::lauritzenetaldivergentwind} (xyz, t)
\begin{DoxyCompactList}\small\item\em Outputs velocity at postion xyz and time t corresponding to the divergent test cases found in \cite{LauritzenEtAl2012}. \end{DoxyCompactList}\item 
real(kreal) function, \\*
dimension(3), public \hyperlink{group__AdvectionRK4_gad30efb36915276cdc54a055b474d93d8}{advectionmodule\+::testcase1velocity} (xyz, t)
\begin{DoxyCompactList}\small\item\em Outputs velocity at postion xyz and time t corresponding to \cite{WilliamsonEtAl1992} test case 1. \end{DoxyCompactList}\item 
real(kreal) function, \\*
dimension(3), public \hyperlink{group__AdvectionRK4_gaad6c3850042d085e15518e2cb9d8909f}{advectionmodule\+::movingvorticesvelocity} (xyz, t)
\begin{DoxyCompactList}\small\item\em Outputs velocity at postion xyz and time t corresponding to \cite{NairJablonowski2008} moving vortices test case. \end{DoxyCompactList}\item 
real(kreal) function, \\*
dimension(3), public \hyperlink{group__AdvectionRK4_ga0001703c78ad97926664935bc766e15c}{advectionmodule\+::kentcascadevelocity} (xyz, t)
\begin{DoxyCompactList}\small\item\em Outputs velocity at postion xyz and time t corresponding to \cite{KentEtAl2012} tracer cascade test case. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Provides data structures and methods for R\+K4 timestepping meshes in advection problems on a sphere. 

\begin{DoxyAuthor}{Author}
Peter Bosler, Department of Mathematics, University of Michigan 
\end{DoxyAuthor}


\subsection{Function/\+Subroutine Documentation}
\hypertarget{group__AdvectionRK4_ga9a42b57d9bea0b541418b2bb32ae1ba1}{\index{Advection@{Advection}!advectionrk4timestep@{advectionrk4timestep}}
\index{advectionrk4timestep@{advectionrk4timestep}!Advection@{Advection}}
\subsubsection[{advectionrk4timestep}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public advectionmodule\+::advectionrk4timestep (
\begin{DoxyParamCaption}
\item[{type(advrk4data), intent(inout)}]{self, }
\item[{type(spheremesh), intent(inout)}]{a\+Mesh, }
\item[{real(kreal), intent(in)}]{dt, }
\item[{real(kreal), intent(in)}]{t, }
\item[{integer(kint), intent(in)}]{proc\+Rank, }
\item[{integer(kint), intent(in)}]{n\+Procs, }
\item[{procedure(advectionvelocity)}]{velocity\+Function}
\end{DoxyParamCaption}
)}}\label{group__AdvectionRK4_ga9a42b57d9bea0b541418b2bb32ae1ba1}


Advances a spherical mesh advection problem one time step using 4th order Runge-\/\+Kutta. 

\begin{DoxyAuthor}{Author}
Peter Bosler. 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em dt} & double precision real, timestep size \\
\hline
\mbox{\tt in}  & {\em t} & double precision real, current simulation time \\
\hline
\mbox{\tt in}  & {\em proc\+Rank} & integer, M\+P\+I process rank \\
\hline
\mbox{\tt in}  & {\em n\+Procs} & integer, number of M\+P\+I processes \\
\hline
\mbox{\tt in}  & {\em velocity\+Function,interface} & to advection velocity functions \\
\hline
\mbox{\tt in,out}  & {\em self} & Advection\+R\+K4 object \\
\hline
\mbox{\tt in,out}  & {\em a\+Mesh} & Sphere\+Mesh object \\
\hline
\end{DoxyParams}


Definition at line 381 of file Advection2.\+f90.



References panelsmodule\+::scatterpanels(), and advectionmodule\+::zerork4().



Referenced by gaussianhillsadvection(), gaussianhillsadvectiondirect(), kentcascadeadvection(), movingvorticesadvection(), and testcase1().

\hypertarget{group__AdvectionRK4_ga0001703c78ad97926664935bc766e15c}{\index{Advection@{Advection}!kentcascadevelocity@{kentcascadevelocity}}
\index{kentcascadevelocity@{kentcascadevelocity}!Advection@{Advection}}
\subsubsection[{kentcascadevelocity}]{\setlength{\rightskip}{0pt plus 5cm}real(kreal) function, dimension(3), public advectionmodule\+::kentcascadevelocity (
\begin{DoxyParamCaption}
\item[{real(kreal), dimension(3), intent(in)}]{xyz, }
\item[{real(kreal), intent(in)}]{t}
\end{DoxyParamCaption}
)}}\label{group__AdvectionRK4_ga0001703c78ad97926664935bc766e15c}


Outputs velocity at postion xyz and time t corresponding to \cite{KentEtAl2012} tracer cascade test case. 

\begin{DoxyAuthor}{Author}
Peter Bosler 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em xyz} & double precision real, size(3); position vector in Cartesian coordinates of a point on the sphere \\
\hline
\mbox{\tt in}  & {\em t} & double precision real; current value of simulation time variable \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
velocity vector double precision real, size(3); tangent to sphere 
\end{DoxyReturn}


Definition at line 860 of file Advection2.\+f90.



Referenced by kentcascadeadvection().

\hypertarget{group__AdvectionRK4_ga8f7661486a24b73e0ccff377adfb29db}{\index{Advection@{Advection}!lauritzenetaldivergentwind@{lauritzenetaldivergentwind}}
\index{lauritzenetaldivergentwind@{lauritzenetaldivergentwind}!Advection@{Advection}}
\subsubsection[{lauritzenetaldivergentwind}]{\setlength{\rightskip}{0pt plus 5cm}real(kreal) function, dimension(3), public advectionmodule\+::lauritzenetaldivergentwind (
\begin{DoxyParamCaption}
\item[{real(kreal), dimension(3), intent(in)}]{xyz, }
\item[{real(kreal), intent(in)}]{t}
\end{DoxyParamCaption}
)}}\label{group__AdvectionRK4_ga8f7661486a24b73e0ccff377adfb29db}


Outputs velocity at postion xyz and time t corresponding to the divergent test cases found in \cite{LauritzenEtAl2012}. 

\begin{DoxyAuthor}{Author}
Peter Bosler 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em xyz} & double precision real, size(3); position vector in Cartesian coordinates of a point on the sphere \\
\hline
\mbox{\tt in}  & {\em t} & double precision real; current value of simulation time variable \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
velocity vector double precision real, size(3); tangent to sphere 
\end{DoxyReturn}


Definition at line 761 of file Advection2.\+f90.

\hypertarget{group__AdvectionRK4_ga7f11298031417d6f2c3987bd4b363c37}{\index{Advection@{Advection}!lauritzenetalnondivergentwind@{lauritzenetalnondivergentwind}}
\index{lauritzenetalnondivergentwind@{lauritzenetalnondivergentwind}!Advection@{Advection}}
\subsubsection[{lauritzenetalnondivergentwind}]{\setlength{\rightskip}{0pt plus 5cm}real(kreal) function, dimension(3), public advectionmodule\+::lauritzenetalnondivergentwind (
\begin{DoxyParamCaption}
\item[{real(kreal), dimension(3), intent(in)}]{xyz, }
\item[{real(kreal), intent(in)}]{t}
\end{DoxyParamCaption}
)}}\label{group__AdvectionRK4_ga7f11298031417d6f2c3987bd4b363c37}


Outputs velocity at postion xyz and time t corresponding to the non-\/divergent test cases found in \cite{LauritzenEtAl2012}. 

\begin{DoxyAuthor}{Author}
Peter Bosler 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em xyz} & double precision real, size(3); position vector in Cartesian coordinates of a point on the sphere \\
\hline
\mbox{\tt in}  & {\em t} & double precision real; current value of simulation time variable \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
velocity vector double precision real, size(3); tangent to sphere 
\end{DoxyReturn}


Definition at line 727 of file Advection2.\+f90.



Referenced by gaussianhillsadvection(), and gaussianhillsadvectiondirect().

\hypertarget{group__AdvectionRK4_gaad6c3850042d085e15518e2cb9d8909f}{\index{Advection@{Advection}!movingvorticesvelocity@{movingvorticesvelocity}}
\index{movingvorticesvelocity@{movingvorticesvelocity}!Advection@{Advection}}
\subsubsection[{movingvorticesvelocity}]{\setlength{\rightskip}{0pt plus 5cm}real(kreal) function, dimension(3), public advectionmodule\+::movingvorticesvelocity (
\begin{DoxyParamCaption}
\item[{real(kreal), dimension(3), intent(in)}]{xyz, }
\item[{real(kreal), intent(in)}]{t}
\end{DoxyParamCaption}
)}}\label{group__AdvectionRK4_gaad6c3850042d085e15518e2cb9d8909f}


Outputs velocity at postion xyz and time t corresponding to \cite{NairJablonowski2008} moving vortices test case. 

\begin{DoxyAuthor}{Author}
Peter Bosler 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em xyz} & double precision real, size(3); position vector in Cartesian coordinates of a point on the sphere \\
\hline
\mbox{\tt in}  & {\em t} & double precision real; current value of simulation time variable \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
velocity vector double precision real, size(3); tangent to sphere 
\end{DoxyReturn}


Definition at line 820 of file Advection2.\+f90.



References spheregeommodule\+::atan4().



Referenced by movingvorticesadvection().

\hypertarget{group__AdvectionRK4_ga0eaf17769aa944b4bded630e3eb300c1}{\index{Advection@{Advection}!setalpha@{setalpha}}
\index{setalpha@{setalpha}!Advection@{Advection}}
\subsubsection[{setalpha}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public advectionmodule\+::setalpha (
\begin{DoxyParamCaption}
\item[{real(kreal), intent(in)}]{new\+Alpha}
\end{DoxyParamCaption}
)}}\label{group__AdvectionRK4_ga0eaf17769aa944b4bded630e3eb300c1}


Sets the angle of inclination (relative to the z-\/axis) for solid body rotation. 

\begin{DoxyAuthor}{Author}
Peter Bosler 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em new\+Alpha} & double precision real \\
\hline
\end{DoxyParams}


Definition at line 650 of file Advection2.\+f90.

\hypertarget{group__AdvectionRK4_gad30efb36915276cdc54a055b474d93d8}{\index{Advection@{Advection}!testcase1velocity@{testcase1velocity}}
\index{testcase1velocity@{testcase1velocity}!Advection@{Advection}}
\subsubsection[{testcase1velocity}]{\setlength{\rightskip}{0pt plus 5cm}real(kreal) function, dimension(3), public advectionmodule\+::testcase1velocity (
\begin{DoxyParamCaption}
\item[{real(kreal), dimension(3), intent(in)}]{xyz, }
\item[{real(kreal), intent(in)}]{t}
\end{DoxyParamCaption}
)}}\label{group__AdvectionRK4_gad30efb36915276cdc54a055b474d93d8}


Outputs velocity at postion xyz and time t corresponding to \cite{WilliamsonEtAl1992} test case 1. 

\begin{DoxyAuthor}{Author}
Peter Bosler 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em xyz} & double precision real, size(3); position vector in Cartesian coordinates of a point on the sphere \\
\hline
\mbox{\tt in}  & {\em t} & double precision real; current value of simulation time variable \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
velocity vector double precision real, size(3); tangent to sphere 
\end{DoxyReturn}


Definition at line 794 of file Advection2.\+f90.



Referenced by cubedspheretest(), and testcase1().

\hypertarget{group__AdvectionRK4_ga60bf7e4fea5c15f0e916c04888b9770b}{\index{Advection@{Advection}!zerork4@{zerork4}}
\index{zerork4@{zerork4}!Advection@{Advection}}
\subsubsection[{zerork4}]{\setlength{\rightskip}{0pt plus 5cm}subroutine, public advectionmodule\+::zerork4 (
\begin{DoxyParamCaption}
\item[{type(advrk4data), intent(inout)}]{self}
\end{DoxyParamCaption}
)}}\label{group__AdvectionRK4_ga60bf7e4fea5c15f0e916c04888b9770b}


Sets arrays used by Runge-\/\+Kutta to zero to prevent contamination of current timestep from previous data. 

\begin{DoxyAuthor}{Author}
Peter Bosler 
\end{DoxyAuthor}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em self} & Advection\+R\+K4 object \\
\hline
\end{DoxyParams}


Definition at line 589 of file Advection2.\+f90.



Referenced by advectionmodule\+::advectionrk4timestep(), bvedirectsummodule\+::bverk4timestep(), planedirectsummodule\+::rk4timestepincompressibleadvection(), planedirectsummodule\+::rk4timestepnorotation(), and swedirectsummodule\+::swerk4timestep().

