\hypertarget{vtkPlotBigRHWave_8cpp}{\section{vtk\+Plot\+Big\+R\+H\+Wave.\+cpp File Reference}
\label{vtkPlotBigRHWave_8cpp}\index{vtk\+Plot\+Big\+R\+H\+Wave.\+cpp@{vtk\+Plot\+Big\+R\+H\+Wave.\+cpp}}
}
{\ttfamily \#include \char`\"{}vtk\+Actor.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vtk\+Camera.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vtk\+Poly\+Data\+Reader.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vtk\+Poly\+Data.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vtk\+Poly\+Data\+Mapper.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vtk\+Property.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vtk\+Property2\+D.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vtk\+Caption\+Actor2\+D.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vtk\+Renderer.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vtk\+Render\+Window.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vtk\+Scalar\+Bar\+Actor.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vtk\+Text\+Actor.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vtk\+Text\+Property.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vtk\+Lookup\+Table.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vtk\+Window\+To\+Image\+Filter.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vtk\+P\+N\+G\+Writer.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vtk\+Scalars\+To\+Colors.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vtk\+Math.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}vtk\+Points.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Model\+Lookup\+Tables.\+h\char`\"{}}\\*
{\ttfamily \#include $<$iostream$>$}\\*
{\ttfamily \#include $<$cmath$>$}\\*
{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include $<$sstream$>$}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{vtkPlotBigRHWave_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}{main} ()
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{vtkPlotBigRHWave_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}{\index{vtk\+Plot\+Big\+R\+H\+Wave.\+cpp@{vtk\+Plot\+Big\+R\+H\+Wave.\+cpp}!main@{main}}
\index{main@{main}!vtk\+Plot\+Big\+R\+H\+Wave.\+cpp@{vtk\+Plot\+Big\+R\+H\+Wave.\+cpp}}
\subsubsection[{main}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{vtkPlotBigRHWave_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}


Definition at line 29 of file vtk\+Plot\+Big\+R\+H\+Wave.\+cpp.



References Get\+Color\+For\+Value\+\_\+\+Blue\+White\+Red(), and Get\+Color\+For\+Value\+\_\+\+N\+C\+L\+Detail().


\begin{DoxyCode}
29           \{
30     \textcolor{comment}{//}
31     \textcolor{comment}{// EARTH CONSTANTS }
32     \textcolor{comment}{//}
33     \textcolor{keywordtype}{double} EARTH\_RADIUS = 6371220.0;
34     \textcolor{keywordtype}{double} ONE\_DAY = 86140.0;
35     \textcolor{keywordtype}{double} GRAVITY = 9.80616;
36     \textcolor{keywordtype}{double} OMEGA = 2.0*3.141592653589793/ONE\_DAY;
37     \textcolor{keywordtype}{double} bounds[6];
38     
39     \textcolor{comment}{//}
40     \textcolor{comment}{// USER PARAMETERS }
41     \textcolor{comment}{// TO DO : Change this section to a user input file (e.g., namelist)}
42     \textcolor{comment}{//}
43     \textcolor{keywordtype}{double} dt = 0.01;
44     \textcolor{keywordtype}{int} frameOut = 1;
45     \textcolor{keywordtype}{int} finalFrame = 35;
46     \textcolor{keywordtype}{double} relVortMin = -6.71E-05;
47     \textcolor{keywordtype}{double} relVortMax = 6.71E05;
48     \textcolor{keywordtype}{bool} showEdges = \textcolor{keyword}{true};
49     \textcolor{keywordtype}{char} vtkFileRoot[128] = \textcolor{stringliteral}{"/Users/pbosler/Desktop/modelData/vtkOut/rhWave\_noRemesh\_quadUnif5\_\_"};
50     \textcolor{keywordtype}{char} imgFileRoot[128] = \textcolor{stringliteral}{"/Users/pbosler/Desktop/modelData/imgOut/rhWave\_noRemesh\_2day\_"};
51     \textcolor{comment}{/* END USER PARAMETERS */}
52     
53     \textcolor{comment}{//}
54     \textcolor{comment}{// initialize input / output}
55     \textcolor{comment}{//}
56     \textcolor{keywordtype}{char} outputCounterString[4];
57     \textcolor{keywordtype}{int} outputCounter;
58 
59     vtkPolyDataReader* relVortData[finalFrame + 1];
60     vtkPolyDataReader* meshData[finalFrame + 1];
61     vtkPolyDataReader* flowMapData[finalFrame + 1];
62     
63     cout << \textcolor{stringliteral}{"initializing vtk file readers ... "};
64     \textcolor{keywordtype}{int} j;
65     \textcolor{keywordtype}{char} vtkFileName[128];
66     \textcolor{keywordtype}{char} imgFileName[128];
67     \textcolor{keywordflow}{for} (outputCounter = 0; outputCounter <= finalFrame; outputCounter++ )\{
68         \textcolor{comment}{// set file names}
69         j = sprintf(outputCounterString,\textcolor{stringliteral}{"%04d"},outputCounter);
70         strcpy(vtkFileName,vtkFileRoot);
71         strcat(vtkFileName,outputCounterString);
72         strcat(vtkFileName,\textcolor{stringliteral}{".vtk"});
73         
74         \textcolor{comment}{// initialize vtkPolyData readers}
75         relVortData[outputCounter] = vtkPolyDataReader::New();
76             relVortData[outputCounter] -> SetFileName(vtkFileName);
77             relVortData[outputCounter] -> SetScalarsName(\textcolor{stringliteral}{"RelVort"});
78         
79         meshData[outputCounter] = vtkPolyDataReader::New();
80             meshData[outputCounter] -> SetFileName(vtkFileName);
81             meshData[outputCounter] -> SetScalarsName(\textcolor{stringliteral}{"Tracer2"});
82             
83         flowMapData[outputCounter] = vtkPolyDataReader::New();
84             flowMapData[outputCounter] -> SetFileName(vtkFileName);
85             flowMapData[outputCounter] -> SetScalarsName(\textcolor{stringliteral}{"Tracer1"});
86     \}
87     cout << \textcolor{stringliteral}{"... done. \(\backslash\)n"};
88     
89     cout << \textcolor{stringliteral}{"initializing lookup tables ... "};
90     \textcolor{keywordtype}{int} numColors = 1024;
91     \textcolor{keywordtype}{double} r, g, b, val;
92     vtkLookupTable* vortScale = vtkLookupTable::New();
93         vortScale->SetRange(relVortMin,relVortMax);
94         \textcolor{keywordtype}{double} vortRange = relVortMax - relVortMin;
95         vortScale->SetNumberOfTableValues(numColors);
96         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < numColors; i++)\{
97             val = relVortMin + ( (double)i/numColors)*vortRange;
98             \textcolor{comment}{//}
99             \textcolor{comment}{// choose colormap for vorticity}
100             \textcolor{comment}{//}
101             \hyperlink{ModelLookupTables_8cpp_a61b2630cfebc72a930f9e7adca93582f}{GetColorForValue\_BlueWhiteRed}(val,r,g,b,relVortMin,relVortMax);
102             
103             vortScale -> SetTableValue(i,r,g,b);
104         \}
105     vortScale -> Build();
106     
107     \textcolor{keywordtype}{double} latMin = -1.5708;
108     \textcolor{keywordtype}{double} latMax = 1.5708;
109     \textcolor{keywordtype}{double} latRange = latMax - latMin;
110     vtkLookupTable* latScale = vtkLookupTable::New();
111         latScale -> SetRange(latMin,latMax);
112         latScale -> SetNumberOfTableValues(numColors);
113         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} i = 0; i < numColors; i++)\{
114             val = latMin + ( (double)i/numColors)*latRange;
115             \textcolor{comment}{//}
116             \textcolor{comment}{// choose colormap for latitude tracers}
117             \textcolor{comment}{//}
118             \hyperlink{ModelLookupTables_8cpp_a7d92db7cb13cdb73a766f5fe804f3f20}{GetColorForValue\_NCLDetail}(val,r,g,b,latMin,latMax);
119             
120             latScale -> SetTableValue(i,r,g,b);
121         \}   
122     latScale -> Build();
123     cout << \textcolor{stringliteral}{"... done. \(\backslash\)n"}; 
124     
125     \textcolor{comment}{//}
126     \textcolor{comment}{//  initialize graphics pipeline}
127     \textcolor{comment}{//}
128     cout << \textcolor{stringliteral}{"initializing graphics pipeline ... "};
129         \textcolor{comment}{//}
130         \textcolor{comment}{//  data mappers}
131         \textcolor{comment}{//}
132         vtkPolyDataMapper* sphereMapper1 = vtkPolyDataMapper::New();
133             sphereMapper1 -> SetScalarRange(relVortMin,relVortMax);
134             sphereMapper1 -> SetLookupTable(vortScale);
135         vtkPolyDataMapper* sphereMapper2 = vtkPolyDataMapper::New();
136             sphereMapper2 -> SetScalarRange(latMin,latMax);
137             sphereMapper2 -> SetLookupTable(latScale);
138         vtkPolyDataMapper* sphereMapper3 = vtkPolyDataMapper::New();
139             sphereMapper3 -> SetScalarRange(latMin,latMax);
140             sphereMapper3 -> SetLookupTable(latScale);
141         
142         \textcolor{comment}{//}
143         \textcolor{comment}{// graphics actors}
144         \textcolor{comment}{//}
145         vtkActor* sphereActor1 = vtkActor::New();
146             sphereActor1 -> SetMapper(sphereMapper1);
147         vtkActor* sphereActor2 = vtkActor::New();
148             sphereActor2 -> SetMapper(sphereMapper2);
149         vtkActor* sphereActor3 = vtkActor::New();       
150             sphereActor3 -> SetMapper(sphereMapper3);
151             \textcolor{keywordflow}{if} ( showEdges ) \{
152                 sphereActor3 -> GetProperty() -> EdgeVisibilityOn();
153                 sphereActor3 -> GetProperty() -> SetEdgeColor(0.0,0.0,0.0);
154                 sphereActor3 -> GetProperty() -> SetColor(1.0,1.0,1.0);
155             \}
156         
157         \textcolor{comment}{//}
158         \textcolor{comment}{// colorbar actors}
159         \textcolor{comment}{//}
160         vtkTextProperty* colorbarLabelProperties = vtkTextProperty::New();
161             colorbarLabelProperties->SetColor(0.0,0.0,0.0);
162             colorbarLabelProperties->SetFontSize(12);
163         vtkScalarBarActor* vortColorbar = vtkScalarBarActor::New();
164             vortColorbar->SetTitle(\textcolor{stringliteral}{"Rel. Vort. < s^(-1) >"});
165             vortColorbar->GetTitleTextProperty()->SetColor(0.0,0.0,0.0);
166             vortColorbar->GetTitleTextProperty()->SetFontSize(12);
167             vortColorbar->SetLabelTextProperty(colorbarLabelProperties);
168             vortColorbar->SetOrientationToVertical();
169             vortColorbar->SetPosition(0.015,0.1);
170             vortColorbar->SetPosition2(0.9,0.9);
171             vortColorbar->SetWidth(0.2);
172             vortColorbar->SetLookupTable(vortScale);
173         vtkScalarBarActor* latColorbar = vtkScalarBarActor::New();
174             latColorbar->SetTitle(\textcolor{stringliteral}{"Init. Latitude"});
175             latColorbar->GetTitleTextProperty()->SetColor(0.0,0.0,0.0);
176             latColorbar->GetTitleTextProperty()->SetFontSize(12);
177             latColorbar->SetLabelTextProperty(colorbarLabelProperties);
178             latColorbar->SetOrientationToVertical();
179             latColorbar->SetPosition(0.015,0.1);
180             latColorbar->SetPosition2(0.9,0.9);
181             latColorbar->SetWidth(0.2);
182             latColorbar->SetLookupTable(latScale);
183         vtkScalarBarActor* alphaColorbar = vtkScalarBarActor::New();
184             alphaColorbar->SetTitle(\textcolor{stringliteral}{"Lat(alpha)"});
185             alphaColorbar->GetTitleTextProperty()->SetColor(0.0,0.0,0.0);
186             alphaColorbar->GetTitleTextProperty()->SetFontSize(12);
187             alphaColorbar->SetLabelTextProperty(colorbarLabelProperties);
188             alphaColorbar->SetOrientationToVertical();
189             alphaColorbar->SetPosition(0.015,0.1);
190             alphaColorbar->SetPosition2(0.9,0.9);
191             alphaColorbar->SetWidth(0.2);
192             alphaColorbar->SetLookupTable(latScale);    
193         
194         \textcolor{comment}{//}
195         \textcolor{comment}{// text annotation}
196         \textcolor{comment}{//}
197         vtkTextActor* textActor1 = vtkTextActor::New();
198             textActor1->SetTextScaleModeToProp();
199             textActor1->SetPosition(0.1,0.1);
200             textActor1->SetPosition2(0.8,0.3);
201             textActor1->GetTextProperty()->SetColor(0.0,0.0,0.0);
202             
203         
204         \textcolor{comment}{//}
205         \textcolor{comment}{// cameras}
206         \textcolor{comment}{//}
207         vtkCamera* camera1 = vtkCamera::New();
208             camera1 -> SetPosition(8000,2.0,2.0);
209             camera1 -> SetFocalPoint(0.0,0.0,0.0);
210         vtkCamera* camera2 = vtkCamera::New();
211             camera2 -> SetPosition(2.0*EARTH\_RADIUS,2.0*EARTH\_RADIUS,2.0*EARTH\_RADIUS);
212             \textcolor{comment}{//camera2 -> SetViewUp(0.0,0.0,1.0);}
213             camera2 -> SetFocalPoint(0.0,0.0,0.0);
214             
215         \textcolor{comment}{//}
216         \textcolor{comment}{// renderers}
217         \textcolor{comment}{//}
218         vtkRenderer* renderer1 = vtkRenderer::New();
219             renderer1 -> AddActor(sphereActor1);
220             renderer1 -> AddActor(vortColorbar);
221             renderer1 -> AddActor(textActor1);
222             renderer1 -> SetActiveCamera(camera1);
223             renderer1 -> SetBackground(1.0,1.0,1.0);
224             renderer1 -> SetViewport(0.0,0.0,0.3333,1.0);
225         vtkRenderer* renderer2 = vtkRenderer::New();
226             renderer2 -> AddActor(sphereActor2);
227             renderer2 -> AddActor(latColorbar);
228             renderer2 -> SetActiveCamera(camera2);
229             renderer2 -> SetBackground(1.0,1.0,1.0);
230             renderer2 -> SetViewport(0.3333,0.0,0.6666,1.0);        
231         vtkRenderer* renderer3 = vtkRenderer::New();
232             renderer3 -> AddActor(sphereActor3);
233             renderer3 -> AddActor(alphaColorbar);
234             renderer3 -> SetActiveCamera(camera2);
235             renderer3 -> SetBackground(1.0,1.0,1.0);
236             renderer3 -> SetViewport(0.6666,0.0,1.0,1.0);       
237         
238         \textcolor{comment}{//}
239         \textcolor{comment}{// render window}
240         \textcolor{comment}{//}
241         vtkRenderWindow* renWin = vtkRenderWindow::New();
242             renWin->AddRenderer(renderer1);
243             renWin->AddRenderer(renderer2);
244             renWin->AddRenderer(renderer3);
245             renWin->SetSize(1800,600);
246         
247         \textcolor{comment}{//}
248         \textcolor{comment}{// window to image filter and image writer}
249         \textcolor{comment}{//}
250         vtkWindowToImageFilter* win2im = vtkWindowToImageFilter::New();
251             win2im->SetInput(renWin);
252         vtkPNGWriter* writer = vtkPNGWriter::New();
253     cout << \textcolor{stringliteral}{"... done. \(\backslash\)n"}; 
254     
255     \textcolor{comment}{//}
256     \textcolor{comment}{// RENDERING LOOP}
257     \textcolor{comment}{//}
258     cout << \textcolor{stringliteral}{"... RENDERING ... \(\backslash\)n"};
259     vtkPoints* points1 = vtkPoints::New();
260     vtkPoints* points2 = vtkPoints::New();
261     vtkPoints* points3 = vtkPoints::New();
262     vtkPolyData* polydata1 = vtkPolyData::New();
263     vtkPolyData* polydata2 = vtkPolyData::New();
264     vtkPolyData* polydata3 = vtkPolyData::New();
265     \textcolor{keywordtype}{int} nActive = 0;
266     \textcolor{keywordtype}{char} titleString[64];
267     \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} frameJ = 0; frameJ <= finalFrame; frameJ++)\{
268         \textcolor{comment}{//}
269         \textcolor{comment}{// annotation string}
270         \textcolor{comment}{//}
271         j = sprintf(titleString,\textcolor{stringliteral}{"t = %7.4f, N = %8d"},frameJ*dt*frameOut,nActive);
272         textActor1 -> SetInput(titleString);
273         
274         \textcolor{comment}{//}
275         \textcolor{comment}{// read data}
276         \textcolor{comment}{//}
277         polydata1->DeepCopy(relVortData[frameJ]->GetOutput());
278         polydata2->DeepCopy(meshData[frameJ]->GetOutput());
279         polydata3->DeepCopy(flowMapData[frameJ]->GetOutput());
280     
281         points1 = polydata1->GetPoints();
282         points2 = polydata2->GetPoints();
283         points3 = polydata3->GetPoints();
284         
285         \textcolor{comment}{//}
286         \textcolor{comment}{// normalize sphere to fit in single precision OpenGL used by VTK rendering}
287         \textcolor{comment}{//}
288         \textcolor{keywordflow}{for} ( vtkIdType i = 0; i < polydata1->GetNumberOfPoints(); i++)\{
289             
290             \textcolor{keywordtype}{double} xyz[3];
291             \textcolor{keywordtype}{double} norm;
292             
293             points1->GetPoint(i,xyz);
294             norm = sqrt( xyz[0]*xyz[0] + xyz[1]*xyz[1] + xyz[2]*xyz[2]);
295             
296             xyz[0]/=norm;
297             xyz[1]/=norm;
298             xyz[2]/=norm;
299             
300             points1->SetPoint(i,xyz);
301             points2->SetPoint(i,xyz);
302             points3->SetPoint(i,xyz);
303         
304         \}
305         polydata1->SetPoints(points1);
306         polydata2->SetPoints(points2);
307         polydata3->SetPoints(points3);
308         sphereMapper1 -> SetInput(polydata1);
309         sphereMapper2 -> SetInput(polydata2);
310         sphereMapper3 -> SetInput(polydata3);
311         
312         \textcolor{comment}{//}
313         \textcolor{comment}{// render}
314         \textcolor{comment}{//}
315         renWin -> Render();
316         win2im -> Modified();
317         
318         \textcolor{comment}{//}
319         \textcolor{comment}{// output frame to file}
320         \textcolor{comment}{//}
321         j = sprintf(outputCounterString,\textcolor{stringliteral}{"%04d"},frameJ);
322         strcpy(imgFileName,imgFileRoot);
323         strcat(imgFileName,outputCounterString);
324         strcat(imgFileName,\textcolor{stringliteral}{".png"});
325         
326         writer -> SetInput(win2im->GetOutput());
327         writer -> SetFileName(imgFileName);
328         writer -> Write();
329         
330         \textcolor{comment}{// TO DO : nActive for AMR}
331         nActive = relVortData[frameJ]->GetOutput()->GetNumberOfCells();
332         nActive = nActive/4;
333         
334         \textcolor{comment}{// }
335         \textcolor{comment}{// track progress}
336         \textcolor{comment}{//}
337         \textcolor{keywordflow}{if} ( frameJ == finalFrame/4)\{cout << \textcolor{stringliteral}{"... 25\(\backslash\)% done.\(\backslash\)n"};\}
338         \textcolor{keywordflow}{if} ( frameJ == finalFrame/2)\{cout << \textcolor{stringliteral}{"... 50\(\backslash\)% done.\(\backslash\)n"};\}
339         \textcolor{keywordflow}{if} ( frameJ == 3*finalFrame/4)\{cout << \textcolor{stringliteral}{"... 75\(\backslash\)% done.\(\backslash\)n"};\}
340         
341     \}       
342     cout << \textcolor{stringliteral}{"... RENDERING COMPLETE.\(\backslash\)n"};
343                 
344     \textcolor{comment}{//}
345     \textcolor{comment}{// clean up / free memory}
346     \textcolor{comment}{//}
347     polydata1->Delete();
348     polydata2->Delete();
349     polydata3->Delete();
350     points1->Delete();
351     points2->Delete();
352     points3->Delete();
353     win2im->Delete();
354     writer->Delete();
355     renWin->Delete();
356     renderer1->Delete();
357     renderer2->Delete();
358     renderer3->Delete();
359     camera1->Delete();
360     camera2->Delete();
361     textActor1->Delete();
362     alphaColorbar->Delete();
363     vortColorbar->Delete();
364     latColorbar->Delete();
365     colorbarLabelProperties->Delete();
366     sphereActor1->Delete();
367     sphereActor2->Delete();
368     sphereActor3->Delete();
369     sphereMapper1->Delete();
370     sphereMapper2->Delete();
371     sphereMapper3->Delete();
372     vortScale->Delete();
373     latScale->Delete();
374     \textcolor{keywordflow}{for} (outputCounter = 0; outputCounter <= finalFrame; outputCounter++ )\{
375         \textcolor{comment}{// delete vtkPolyData readers}
376         relVortData[outputCounter] -> Delete();
377         meshData[outputCounter] -> Delete();
378         flowMapData[outputCounter] -> Delete();
379     \}
380 \}\end{DoxyCode}
