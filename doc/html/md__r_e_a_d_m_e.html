<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>Lagrangian Particle / Panel Methods (LPPM): LPPM : Lagrangian Particle / Panel Method</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Lagrangian Particle / Panel Methods (LPPM)
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">LPPM is a fluid dynamics solver based on Lagrangian particle methods</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">LPPM : Lagrangian Particle / Panel Method </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Code associated with</p>
<p>P. Bosler, L. Wang, R. Krasny, and C. Jablonowski, 2014. "A Lagrangian particle/panel method for the barotropic vorticity equation on a rotating sphere," Fluid Dynamics Research, 46 : 031406.</p>
<p>Bosler, P. A., "Particle Methods for Geophysical Flow on the Sphere," PhD Thesis, University of Michigan, 2013.</p>
<p>This software provides a Lagrangian Particle-Panel Method for solving the barotropic vorticity equation and the advection equation on the sphere and in the plane.</p>
<p>A shallow water equation solver is in development.</p>
<h1>Design / Use </h1>
<p>Although it is written in modern Fortran rather than C++, the code is organized in an object-oriented style. This means that for each task the code performs, there is a derived data type that corresponds to that task (like a C++ class). Each module file contains one derived data type and its associated methods. For example, <a class="el" href="_plane_mesh_8f90.html" title="Combines primitives (particles, edges, and panels) to form planar mesh objects; plus mesh functions /...">PlaneMesh.f90</a> contains the data type for moving meshes in the plane and interfaces to all the functions that are implemented on PlaneMesh objects. The <a class="el" href="_plane_direct_sum_8f90.html" title="Provides RK4 time stepping for the 2d incompressible equations using direct summation. ">PlaneDirectSum.f90</a> module defines the Runge-Kutta time stepping data type for plane meshes, and contains all of the timestepping functions.</p>
<p>Each object must be created in memory using its New method, many objects must then be initialized using a call to an Init or Initialize subroutine. For clean code, every time a New subroutine is called on an object, a corresponding call to that object's Delete subroutine should be used when the object is no longer needed or goes out of scope.</p>
<h2>Example: </h2>
<p>To define a Rossby-Haurwitz wave vorticity distribution for a sphere mesh, a user would first allocate the VorticitySetup object by calling its New subroutine. Then the wave would be initialized with user-defined parameters (most commonly read from a namelist file) by calling the VorticitySetup module's InitRHWave routine. Finally, the wave is defined and users can define the vorticity on a sphere mesh by calling the SetRHWaveOnMesh subroutine. </p><pre class="fragment">call New(rhWave, nIntegers, nReals)
call InitRH4Wave(rhWave, backgoundWindSpeed, amplitude)
call SetRH4WaveOnMesh( sphere, rhWave)
</pre><p>Code runs... </p><pre class="fragment">call Delete(rhWave) 
</pre><h2>To create a new test case: </h2>
<p>The first step is to create the object that will control your test case, either a tracer or a vorticity distribution, in the <a class="el" href="_tracers_8f90.html" title="defines passive tracer distributions for flows in spherical geometry ">Tracers.f90</a> or <a class="el" href="_b_v_e_vorticity_8f90.html" title="defines vorticity distributions for barotropic flows in spherical geometry ">BVEVorticity.f90</a> files. Test cases are defined by BVESetup or TracerSetup objects. These objects hold the integers and real numbers that define your test case; numbers that, for example, define the amplitude of a Rossby-Haurwitz wave or the maximum value of an advected tracer. To create the object the first step is to allocate the memory to hold these parameters using the "New" subroutine. </p><pre class="fragment">call New(rhWave, RHWAVE_N_INT, RHWAVE_N_REAL)
</pre><p>RHWAVE_N_INIT and RHWAVE_N_REAL are integer constants defined in the BVESetup.f90 module; their values are 0 and 2 for the RH4 test case, which indicates that this test case is defined by 2 real numbers (the ampilitude and phase speeed of the wave). Now that memory is allocated to hold these parameters, the test case must be initialized from user input (typically read from a namelist file). If the variables backgroundWindSpeed and amplitude are set by the user, the test case is defind by calling the "Init" subroutine on the test case object. </p><pre class="fragment">call InitRH4Wave(rhWave, backgroundWindSpeed, amplitude)
</pre><p>Finally and most importantly is the subroutine which translates a test case into a tracer or vorticity distribution over a mesh. These subroutine must all have the same interface &ndash; only 2 arguments, the first being a mesh object and second being the test case definition. This interface is required in order for the LagrangianRemeshing subroutines to work properly. </p><pre class="fragment">call SetRH4WaveOnMesh( aMesh, rhWave)
</pre><p>SetRH4WaveOnMesh calls the mathematical functions that define the vorticity distribution of a Rossby-Haurwitz wave, given the parameters defined by the rhWave test case object.</p>
<p>To create a new test case then, users must first decide how many integers and reals are required to define their test case, and allocate the appropriate amount of memory with the "New" subroutine. Then the test case object must be initialized with an "Init" subroutine to define the parameters in the test case object's memory. Finally, users must write a SetTestCaseOnMesh subroutine and the associated mathematical functions that define their test case.</p>
<h1>Requirements </h1>
<p>The code requires a modern Fortran compiler with an OpenMPI (<a href="http://www.open-mpi.org">http://www.open-mpi.org</a>) distribution for parallel computing. Without OpenMPI serial computations are still possible, but the code is designed to use distributed memory parallelism.</p>
<p>Currently the software is written for Intel compilers and makes use of the Intel MKL software library (LAPACK, specifically). It is possible to use other compilers (e.g. gfortran) provided OpenMPI and LAPACK are also available.</p>
<p>LPPM uses interpolation software provided by ACM TOMS algorithm 526 written by Hiroshi Akima and implemented by John Burkhardt (<a href="https://orion.math.iastate.edu/burkardt/f_src/bivar/bivar.html">https://orion.math.iastate.edu/burkardt/f_src/bivar/bivar.html</a>), and ACM TOMS algorithms 772 and 773 written by Robert Renka. All other code is original and authored by Peter Bosler. </p><pre class="fragment">H. Akima, 1978, A method of bivariate interpolation and smooth surface fitting for irregularly distributed data points.
    ACM TOMS, 4:148-159.
H. Akima, 1984, On estimating partial derivatives for bivariate interpolation of scattered data.
    Rocky Mountain Journal of Mathematics, 14:41-52.
R. Renka, 1997, Algorithm 772 : STRIPACK : Delaunay triangulation and Voronoi diagram on the surface of a sphere.
    ACM TOMS, 23:416-434.
R. Renka, 1997, Algorithm 773 : SSRFPACK : Interpolation of scattered data on the surface of a sphere with a surface under thension.
    ACM TOMS, 23:435-442.
</pre><h1>Plotting and graphics </h1>
<p>LPPM includes subroutines for outputting data into formats readable by the VTK C++ graphics library and ParaView, available from www.kitware.org, as well as routines for the NCAR Command Language (NCL) <a href="http://www.ncl.ucar.edu">http://www.ncl.ucar.edu</a> and Matlab. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Aug 15 2014 15:10:29 for Lagrangian Particle / Panel Methods (LPPM) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
